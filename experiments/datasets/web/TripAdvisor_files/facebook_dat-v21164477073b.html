
<!-- saved from url=(2107)https://static.tacdn.com/static/page_moniker/facebook_dat-v21164477073b.html#pixelType=PAGEVIEW&tadomain=tripadvisor.com&reqUnique=2b3de57e24a051e53b4b7c34a473db1d9ccb592e&userUnique=904d7bcf06f03c225193fe656f632fbd3ed7388a&fbUserUnique=ac6ddc7edae6b98aac5554042d63ca3fae791053c78cb4d4c0a2998c46d500ea&locale=en_US&countryID=189806&seqId=5&device=Desktop&fbDevice=1&userGeo=189806&siteType=d&trueServlet=Home&fbTrueServlet=A&servlet=Home&geoFeedBucket=all&serverName=www.tripadvisor.com&puid=W@L2NgoQJX8AAf9XPcUAAAAX&isMobileDevice=n&rtPath=www.tamgrt.com/RT&random=1389497942&taSplit=1&mcid=10568&fbChannel=2&criteoDedup=0&tasource=SEO&isClickoutYN=no&isLoggedIn=N&securelyLoggedIn=N&stuid=NY1QkB0y0N7ozxKjlUNjmSSVWdu82utjVn_Peu7Egw6ND25um6gx7O_Fvv4o2cYa&countryAlpha2=US&criteoPartnerId=4653&criteoAttractionPartnerId=26270&criteoHotelAcct=%5Ban%3Dweb-hotels-tripadvisor.com%26cn%3Dus%26ln%3Den%2Can%3Dweb-hotels-0-tripadvisor.com%26cn%3Dus%26ln%3Den%2Can%3Dweb-hotels-1-tripadvisor.com%26cn%3Dus%26ln%3Den%2Can%3Dweb-hotels-2-tripadvisor.com%26cn%3Dus%26ln%3Den%5D&flight_originid=&flight_destid=&flight_startdate=2018-11-21&flight_enddate=2018-11-28&dynx_itemid=null_null_20181121_20181128&flight_num_tix=1&attractionShoppingCartTotalPriceUSD=0.00&facebookuvm_v2UlbScore=0.7777653055646072&facebookuvm_v2UlbBucket=23&facebookUlbScore=0.900774494885&facebookUlbBucket=100&googleExperimentSegment=control&googleUlbScore=0.510998467&googleUlbBucket=2&googleuvm_v2UlbBucket=2&googleuvm_v2UlbScore=0.398416219&UVMBESTSCORE=0.08&UVMSCOPE=UVM_V2&UVMSAVEABLE=0&googleuvm_v2.1UlbBucket=1&googleuvm_v2.1UlbScore=0.5436623837114001&googleuvm_v2.1UlbBucketParamName=uvm_display_desktop_bucket&criteoUlbScore=0.5436623837114001&criteoUlbBucket=1&criteoUlbScoreCurrent=0.5436623837114001&criteoUlbBucketCurrent=1&DBISCORE=0.013904290373548133&DBIFLAG=false&mofSlice=80&mofLastUpdated=20181107&smarterTravelPixelID=gqLWKHSnTxes4YmmtgWkqA&smarterTravelPixelDomain=p.smartertravel.com&isSTConversion=false&googleCRMId=50110611636f636a41e4ad82f27943f6a327a04c&rexSplit=c&NanigansTestSegment=0&pixelName=facebook_dat_pixel -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
  </head>
  <body>
    <script src="./666624680067334" async=""></script><script async="" src="./fbevents.js"></script><script type="text/javascript">
      // Pull params from URL (argdict maps keys to values or arrays of values)
      var argdict = {};
      var args = window.location.hash.substring(1).split("&");
      for (var i = 0; i < args.length; i++) {
        var pair = args[i].split("=");

        if (typeof argdict[pair[0]] === "undefined") {
          argdict[pair[0]] = pair[1];
        } else if (typeof argdict[pair[0]] === "string") {
          argdict[pair[0]] = [argdict[pair[0]], pair[1]];
        } else {
          argdict[pair[0]].push(pair[1]);
        }
      }

      var fbPixelName = 'ViewContent'
          , fbContentType = '["hotel","destination"]';
      if (argdict.pixelType === 'CLICKOUT') {
        fbPixelName = 'InitiateCheckout';
      } else if (argdict.trueServlet === 'Tourism' || argdict.trueServlet === 'MobileTourism') {
        fbPixelName = 'Search';
      } else if (argdict.pixelType === 'ENTER_DATES') {
        fbPixelName = 'EnterDates'
      }

      var applicationId = encodeURIComponent(250701451714610);      
      // event name for Dynamic Product Ads
      var eventName = encodeURIComponent(fbPixelName);
      var fbCategory = encodeURIComponent(argdict.fbTrueServlet);
      var fbDevice = encodeURIComponent(argdict.fbDevice);
      var fbDateIn = encodeURIComponent(argdict.fbDateIn);
      var fbDateOut = encodeURIComponent(argdict.fbDateOut);
      var geoId = encodeURIComponent(argdict.geoId);
      // if no property id, returns the geo's most popular property id if there is one
      var PropId = encodeURIComponent(argdict.propId ? argdict.propId : argdict.geoMostPop);
      var mcid = encodeURIComponent(argdict.mcid);
      var countryID = encodeURIComponent(argdict.countryID);
      var fbUserUnique = encodeURIComponent(argdict.fbUserUnique);
      var userUnique = encodeURIComponent(argdict.userUnique);
      var ulbBucket = encodeURIComponent(argdict.facebookUlbBucket);
      var ulbScore = encodeURIComponent(argdict.facebookUlbScore);
      var fbRegion = encodeURIComponent(argdict.regionName);
      var fbCity = encodeURIComponent(argdict.cityName);
      var fbCountry = encodeURIComponent(argdict.countryName);
      var fbDestinationName = encodeURIComponent(argdict.destinationName);
      var fbLocationType = encodeURIComponent(argdict.locationType);
      var fbRetargetingType = encodeURIComponent(argdict.fbRetargetingType);
      var fbUlbMultiplier = encodeURIComponent(argdict.fbUlbMultiplier);

      // Only one model will be calculated for each user - v2, v2.1, or complex
      var uvmV2Bucket;
      var uvmV2Score;
      if (argdict.hasOwnProperty('facebookuvm_complexUlbBucket') && argdict.hasOwnProperty('facebookuvm_complexUlbScore')) {
        uvmV2Bucket = argdict.facebookuvm_complexUlbBucket;
        uvmV2Score = argdict.facebookuvm_complexUlbScore;
      }
      else if (argdict.hasOwnProperty('facebookuvm_v2.1UlbBucket') && argdict.hasOwnProperty('facebookuvm_v2.1UlbScore')) {
        uvmV2Bucket = argdict['facebookuvm_v2.1UlbBucket'];
        uvmV2Score = argdict['facebookuvm_v2.1UlbScore'];
      }
      else {
        uvmV2Bucket = argdict.facebookuvm_v2UlbBucket;
        uvmV2Score = argdict.facebookuvm_v2UlbScore;
      }
      uvmV2Bucket = encodeURIComponent(uvmV2Bucket);
      uvmV2Score = encodeURIComponent(uvmV2Score);

      var dateIn;
      var dateOut;
      if (argdict.timezone !== undefined)
      {
        // Send checkin and checkout dates with time of midnight (actually 11:59pm to keep the date the same) and timezone of the hotel
        dateIn = argdict.dateIn + 'T23:59:59' + argdict.timezone;
        dateOut = argdict.dateOut + 'T23:59:59' + argdict.timezone;
      }
      else
      {
        dateIn = argdict.dateIn;
        dateOut = argdict.dateOut;
      }

      // product ids for Dynamic Product Ads. Currently returning a property product followed by a geo product to ensure the geo product is the last product fired
      var productIds = [];
      if (typeof argdict['loc1'] !== 'undefined') {
        // On Hotels page, loc1 is the top commerce hotel for the geo in the POS.
        // On properties page, loc1 is the actual hotel.
        // In all other pages(e.g. SmartDeals page), loc1 is the top pop hotel of the geo.
        productIds.push(encodeURIComponent('d' + argdict['loc1'] + argdict.locale.replace('_', '')));
      }
      productIds.push(encodeURIComponent(geoId + argdict.locale.replace('_' , '')));
      
      // The following code, except the hashed email logic, is copy pasted from facebook.
      !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
      n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
      n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
      t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
      document,'script','//connect.facebook.net/en_US/fbevents.js');
      
      // Note: Using a variable for the pixel id instead of passing it directly causes FB's pixel helper chrome plug-in to break
      if (typeof argdict['fbHEml'] !== 'undefined') {
        fbq('init', '666624680067334', {em: encodeURIComponent(argdict.fbHEml)});
      }
      else {
        fbq('init', '666624680067334');
      }

      //End of copy paste from facebook.

      // For obfuscated pixel key mapping, see FB_PIXEL_KEY_MAPPING in PageMoniker.java
      // These are used for Facebook DPA ad creation, do not modify without consulting vwang@ or om-fb@
      var params = {
        'application_id' : applicationId,
        'content_type' : fbContentType,
        'content_ids' : productIds,
        'region' : fbRegion,
        'city' : fbCity,
        'country' : fbCountry,
        'destination' : fbDestinationName,
        'types' : fbLocationType,
        'external_id': fbUserUnique,
        'FB1' : fbDateIn,           // fbCheckInDate
        'FB2' : fbDateOut,          // fbCheckOutDate
        'FB3' : geoId,              // destinationCode
        'FB4' : fbDevice,           // fbDevice
        'FB5' : countryID,          // IP country id
        'FB7' : mcid,               // mcid
        'FB8' : fbCategory,         // fbProductType
        'FB9' : PropId,             // propertyID
        'FB10': userUnique,         // userUnique - this is passed so Facebook can match users with data we provided in an offline file (5/13/15)
        'FB13': ulbBucket,          // User level bid bucket (UVM v1)
        'FB14': ulbScore,           // User level bid score (UVM v1)
        'FB17': fbRetargetingType,  // Retargeting type
        'FB18': fbUlbMultiplier,    // User level bid multiplier
        'FB27': uvmV2Bucket,        // ULB bucket for v2 (for testing)
        'FB28': uvmV2Score,         // ULB score for v2 (for testing)
        'user_bucket': uvmV2Bucket  // Parameter for FB's new ULB product 
      };
      if (fbPixelName === 'InitiateCheckout') {
        // Use puid as conversion unique
        params.order_id = argdict.puid;
        params.eid = argdict.puid; // Event id used to deduplicate with S2S events (must match "event_id" set in FBWebEventApiRequestGenerator)
        params.deferred_id = userUnique;
        params.value = argdict.fbBrpc;
        params.currency = 'USD';
      }

      params.checkin_date = dateIn;
      params.checkout_date = dateOut;

      // for Dynamic Product Ads
      if (fbPixelName === 'EnterDates') {
        fbq('trackCustom', eventName, params);
      } else {
        fbq('track', eventName, params);
      }
    </script>
  

</body></html>